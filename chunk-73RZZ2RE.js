import{a as c}from"./chunk-WW3SAFCJ.js";import{D as p,ga as S,p as o,u as f,z as d}from"./chunk-MGSAXUID.js";import"./chunk-OCNYIIP3.js";import"./chunk-M2IX3KDU.js";import{c as g,e as l}from"./chunk-WI3QVC6K.js";import{a as A,b as F}from"./chunk-GPURZ6GA.js";import"./chunk-I7FLOUNH.js";import"./chunk-W26XKMAT.js";import"./chunk-CWUY5SXW.js";import"./chunk-NRBJLISB.js";import"./chunk-FENRIY2T.js";import"./chunk-WDETDPZG.js";import{d as y,f as u}from"./chunk-HX2VGIR2.js";import{d as m}from"./chunk-64QN2VGD.js";import"./chunk-JGEVVXD4.js";import"./chunk-B3FO6PT7.js";import"./chunk-C4UMJHQC.js";import"./chunk-BCREO4Q5.js";import"./chunk-LXFQWIWE.js";import"./chunk-QT6UNBJP.js";import"./chunk-UBFCO3DV.js";import"./chunk-LFH24RLM.js";import"./chunk-Z5Q7KLA4.js";import"./chunk-X4LNX4BR.js";import"./chunk-4XZ6X7MQ.js";import"./chunk-WLHY3MMA.js";import"./chunk-KGVXGH6H.js";import"./chunk-ARRCN5K3.js";import"./chunk-FTDD7QBB.js";import"./chunk-DB3UIQCU.js";import"./chunk-SBHKMV3P.js";import"./chunk-R4A63S45.js";import"./chunk-ETE32IYO.js";import"./chunk-ONUGDWDK.js";import"./chunk-SG7CQU4O.js";import"./chunk-QHVIRF5H.js";import"./chunk-WZDN6K3C.js";import"./chunk-QGVBCWUY.js";import"./chunk-OJQ73TPF.js";import"./chunk-354SCPDU.js";import"./chunk-OVHPPCBL.js";import"./chunk-IYZFKXJ6.js";import"./chunk-CKJ56T2Q.js";import"./chunk-SNFOAZZQ.js";import"./chunk-F6JAWRPN.js";import"./chunk-UHRSAPGQ.js";import"./chunk-V76GWARL.js";import"./chunk-N2WTMF3X.js";async function s(n,a,t,e){if(t.length===1){if(u(t[0]))return c(n,t[0],o(t[1],-1));if(d(t[0]))return c(n,t[0].toArray(),o(t[1],-1))}else if(t.length===2){if(u(t[0]))return c(n,t[0],o(t[1],-1));if(d(t[0]))return c(n,t[0].toArray(),o(t[1],-1));if(f(t[0])){let i=await t[0].load(),r=await w(l.create(t[1],{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC}),e,a);return x(a,await t[0].calculateStatistic(n,r,o(t[2],1e3),a.abortSignal))}}else if(t.length===3&&f(t[0])){let i=await t[0].load(),r=await w(l.create(t[1],{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC}),e,a);return x(a,await t[0].calculateStatistic(n,r,o(t[2],1e3),a.abortSignal))}return c(n,t,-1)}function x(n,a){return a instanceof g?m.fromReaderAsTimeStampOffset(a.toStorageFormat()):a instanceof Date?m.dateJSAndZoneToArcadeDate(a,S(n)):a}async function w(n,a,t){let e=n.getVariables();if(e.length>0){let i={};for(let r of e)i[r]=a.evaluateIdentifier(t,{name:r});n.parameters=i}return n}function E(n){n.mode==="async"&&(n.functions.stdev=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("stdev",a,r,n))},n.functions.variance=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("variance",a,r,n))},n.functions.average=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("mean",a,r,n))},n.functions.mean=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("mean",a,r,n))},n.functions.sum=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("sum",a,r,n))},n.functions.min=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("min",a,r,n))},n.functions.max=function(a,t){return n.standardFunctionAsync(a,t,(e,i,r)=>s("max",a,r,n))},n.functions.count=function(a,t){return n.standardFunctionAsync(a,t,async(e,i,r)=>{if(p(r,1,1,a,t),f(r[0]))return r[0].count(e.abortSignal);if(u(r[0])||y(r[0]))return r[0].length;if(d(r[0]))return r[0].length();throw new F(a,A.InvalidParameter,t)})})}export{E as registerFunctions};
