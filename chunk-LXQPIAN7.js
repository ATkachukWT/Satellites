import{J as u}from"./chunk-QHVIRF5H.js";import{I as n}from"./chunk-WZDN6K3C.js";import{a as l}from"./chunk-QGVBCWUY.js";import{D as p,P as h,u as a}from"./chunk-CKJ56T2Q.js";var i;(function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"})(i||(i={}));var m=class{constructor(){this._resolver=h(),this._status=i.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=i.RESOLVED,this._cleanUp()},()=>{this._status=i.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(r){this._resolvingPromises.push(r),this._tryResolve()}isResolved(){return this._status===i.RESOLVED}isRejected(){return this._status===i.REJECTED}isFulfilled(){return this._status!==i.PENDING}abort(){this._resolver.reject(a())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;let r=h(),s=[...this._resolvingPromises,r.promise],t=this._allPromise=Promise.all(s);t.then(()=>{this.isFulfilled()||this._allPromise!==t||this._resolver.resolve()},_=>{this.isFulfilled()||this._allPromise!==t||p(_)||this._resolver.reject(_)}),r.resolve()}},P=e=>{let r=class extends e{constructor(...s){super(...s),this._promiseProps=new m,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,t){return this._promiseProps.promise.then(()=>this).then(s,t)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s)}};return r=l([n("esri.core.Promise")],r),r},o=class extends P(u){};o=l([n("esri.core.Promise")],o),function(e){e.EsriPromiseMixin=P}(o||(o={}));var R=o;export{R as a};
