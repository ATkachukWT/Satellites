import{a as f}from"./chunk-CQPDHCMH.js";import{b as E}from"./chunk-F5QAIQ3J.js";import"./chunk-3S7MXQDG.js";import"./chunk-N52QLLCJ.js";import"./chunk-WTFHZZK4.js";import{a as be,b as R}from"./chunk-BINXAYMP.js";import"./chunk-ZGGQ3WAU.js";import"./chunk-QO4VV4M2.js";import"./chunk-I775TR7R.js";import"./chunk-FQTXYWH5.js";import"./chunk-KLXERNY4.js";import"./chunk-GWZ4F32U.js";import"./chunk-VCEKZDML.js";import{a as se}from"./chunk-OBYVOHC5.js";import"./chunk-UO5Q6C3A.js";import"./chunk-BNH7YXHY.js";import{r as Se,t as we,u as M}from"./chunk-2XYAAYOE.js";import{a as te}from"./chunk-OOXOZUTM.js";import{a as de}from"./chunk-WQZ56BSL.js";import"./chunk-7JW7DYCQ.js";import"./chunk-UP67O2XH.js";import"./chunk-6CO4643W.js";import"./chunk-TMY7UIU7.js";import"./chunk-BPX3YT3K.js";import"./chunk-LXEWGICX.js";import"./chunk-NIYDRLW4.js";import"./chunk-4K47EN3B.js";import"./chunk-FGY3YBPM.js";import"./chunk-EDOVNTC7.js";import"./chunk-FSWSNKJD.js";import"./chunk-MVDZB4AK.js";import"./chunk-ESSDCWGF.js";import"./chunk-WVKBXQWE.js";import"./chunk-FGEB67EG.js";import"./chunk-YEXMIDOT.js";import"./chunk-GV3ZFCVD.js";import"./chunk-SOEEM7Z7.js";import"./chunk-T7PUQGWM.js";import"./chunk-44A27HB7.js";import"./chunk-47NSYSFY.js";import"./chunk-QXNVQZT7.js";import"./chunk-CAXK5KYB.js";import"./chunk-3CCK7BDD.js";import"./chunk-LNYBTIG7.js";import"./chunk-K7YQAHQ7.js";import"./chunk-J6YGDWJF.js";import"./chunk-YQNUGDFH.js";import"./chunk-QCZ3ZIGQ.js";import"./chunk-IKCK67OG.js";import"./chunk-C4ERY4CA.js";import"./chunk-WDTJILD4.js";import"./chunk-YAZINLP3.js";import"./chunk-IFPD4DIO.js";import"./chunk-KBSNSGCC.js";import"./chunk-NLZLCUU5.js";import"./chunk-RZU6EEB3.js";import"./chunk-NNX76JDG.js";import"./chunk-76O2P2CB.js";import"./chunk-WV5CXXQQ.js";import"./chunk-KBDKZSTB.js";import"./chunk-BAZL6DXF.js";import"./chunk-HPPVXWXI.js";import"./chunk-HBMVPT4U.js";import"./chunk-L6ZFUQTH.js";import"./chunk-4MB4OYWM.js";import"./chunk-XG5NROZE.js";import"./chunk-7OTP74QG.js";import"./chunk-ZU53JDRS.js";import"./chunk-KQEHVUTS.js";import"./chunk-7LUXMWRM.js";import{a as ne}from"./chunk-TO337MWO.js";import{a as me}from"./chunk-WKYBGWI5.js";import"./chunk-62PJ3MJN.js";import"./chunk-OVJTX4VC.js";import"./chunk-55SQMRMH.js";import"./chunk-CQD6CYSR.js";import"./chunk-QDXM6RGS.js";import"./chunk-E3UR4EIC.js";import"./chunk-4Y623NMU.js";import"./chunk-PTAJ247D.js";import"./chunk-O4MHA7YC.js";import"./chunk-XHEYQWRE.js";import{a as ue}from"./chunk-R5HXEPJ3.js";import"./chunk-CJM4TC3F.js";import"./chunk-J5PZXDWN.js";import"./chunk-ME2B26KJ.js";import"./chunk-U7PX7SHO.js";import{a as ae}from"./chunk-DZBH24YT.js";import{a as ve}from"./chunk-7E723FQO.js";import{f as ce,g as fe,h as he,k as ge}from"./chunk-SVJ5AK5B.js";import"./chunk-FXCL7YYQ.js";import"./chunk-NK3VUQOP.js";import"./chunk-HUKD3ORH.js";import"./chunk-NFARB7KW.js";import"./chunk-M7AB4SQK.js";import"./chunk-XN6KHUVJ.js";import"./chunk-3A3BGKXB.js";import"./chunk-BGOXHRAZ.js";import"./chunk-SXNHGK6A.js";import"./chunk-TMZQBNSB.js";import"./chunk-PFSX77NO.js";import"./chunk-ZJWWZWMH.js";import"./chunk-W45QYQK6.js";import"./chunk-I5V562B6.js";import{a as ye}from"./chunk-WT3XCHGP.js";import{a as ie}from"./chunk-CUJB6F5L.js";import{a as xe}from"./chunk-5NHJFBCW.js";import"./chunk-WPZN772I.js";import"./chunk-AZ7O5NEQ.js";import"./chunk-K27EVVBH.js";import"./chunk-AOQ57NDM.js";import"./chunk-VMECOA4F.js";import"./chunk-PHODKV66.js";import"./chunk-JPMGMA4B.js";import"./chunk-JGU5JAYW.js";import"./chunk-LCMPSAU3.js";import"./chunk-CRJDOM7J.js";import"./chunk-BCFGKQ2N.js";import"./chunk-G7BT6VC5.js";import"./chunk-ZPQDV27Y.js";import"./chunk-SIMI7FRM.js";import"./chunk-YQGS4EZO.js";import"./chunk-3REMXE4W.js";import"./chunk-4ABKPPKG.js";import"./chunk-PMVQ5DJK.js";import{d as pe}from"./chunk-I4Q2S2XA.js";import"./chunk-V774RJYN.js";import"./chunk-L2WNUKLP.js";import"./chunk-XITT4JU2.js";import"./chunk-ZBX6HJOS.js";import"./chunk-BSMAMABT.js";import"./chunk-LYNAYPL3.js";import"./chunk-ULANM5YP.js";import"./chunk-2G3SBK6Q.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import"./chunk-KAMRW6HF.js";import"./chunk-6DGDLLNL.js";import"./chunk-UWWWQ44M.js";import"./chunk-BHB4UQZT.js";import"./chunk-DJW5LMRG.js";import"./chunk-ALWV3RJ2.js";import"./chunk-DEH76MSI.js";import"./chunk-LAVV77UH.js";import"./chunk-VTGWQ7AP.js";import"./chunk-TBA3OZMJ.js";import"./chunk-S4QV2MGO.js";import"./chunk-IRI7XXYY.js";import"./chunk-USMAJP2P.js";import"./chunk-PHNFWHVF.js";import"./chunk-4N5OXIEM.js";import"./chunk-W26XKMAT.js";import"./chunk-NQWYPF77.js";import"./chunk-6KRFVLII.js";import"./chunk-CDP4MSRO.js";import"./chunk-BCSLWH5H.js";import"./chunk-JTDXB5TK.js";import"./chunk-CWUY5SXW.js";import"./chunk-KD27XIJC.js";import"./chunk-TPFJWNIU.js";import"./chunk-P25RU3X5.js";import"./chunk-XRRQM4E2.js";import"./chunk-GWBRHLNH.js";import"./chunk-RWCIDBNQ.js";import"./chunk-EM35R6FY.js";import"./chunk-6B5XFA6F.js";import"./chunk-M67YQAIX.js";import"./chunk-NHEQ4TAR.js";import"./chunk-RZF6KTKU.js";import"./chunk-HP4LYRR4.js";import"./chunk-AFC2H4Q3.js";import"./chunk-OLOKUDVI.js";import"./chunk-4G7UTTZJ.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import{a as le}from"./chunk-NRBJLISB.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-FENRIY2T.js";import"./chunk-5HJY3X5Y.js";import"./chunk-6RZAM42M.js";import"./chunk-HX2VGIR2.js";import"./chunk-64QN2VGD.js";import"./chunk-JGEVVXD4.js";import"./chunk-B3FO6PT7.js";import"./chunk-C4UMJHQC.js";import"./chunk-BCREO4Q5.js";import"./chunk-LXFQWIWE.js";import"./chunk-QT6UNBJP.js";import"./chunk-V2GNNIXD.js";import"./chunk-NSYL2RQJ.js";import{a as Z}from"./chunk-SLAWDKDA.js";import"./chunk-MWSXMSWY.js";import"./chunk-JRCKELO6.js";import"./chunk-ZVCMULXF.js";import"./chunk-KJULKTB5.js";import"./chunk-LACL4BQ2.js";import{c as y}from"./chunk-YR2HD3ZC.js";import"./chunk-GJASVPF6.js";import"./chunk-UBFCO3DV.js";import"./chunk-NI7FJV5X.js";import"./chunk-XZIOXVVJ.js";import"./chunk-5RAXVJQI.js";import"./chunk-EXJYW3PC.js";import{a as re}from"./chunk-SXQPBCOX.js";import"./chunk-LFH24RLM.js";import"./chunk-Z5Q7KLA4.js";import{a as A}from"./chunk-X4LNX4BR.js";import{a as oe}from"./chunk-4XZ6X7MQ.js";import"./chunk-WLHY3MMA.js";import"./chunk-KGVXGH6H.js";import"./chunk-ARRCN5K3.js";import{a as Y}from"./chunk-LXQPIAN7.js";import"./chunk-FTDD7QBB.js";import"./chunk-DB3UIQCU.js";import"./chunk-SBHKMV3P.js";import"./chunk-R4A63S45.js";import{E as ee}from"./chunk-ETE32IYO.js";import{w as Q}from"./chunk-ONUGDWDK.js";import{f as n}from"./chunk-SG7CQU4O.js";import{H as o}from"./chunk-QHVIRF5H.js";import{I as i}from"./chunk-WZDN6K3C.js";import{a as r}from"./chunk-QGVBCWUY.js";import"./chunk-OJQ73TPF.js";import"./chunk-354SCPDU.js";import"./chunk-OVHPPCBL.js";import"./chunk-IYZFKXJ6.js";import{y as X}from"./chunk-CKJ56T2Q.js";import"./chunk-SNFOAZZQ.js";import"./chunk-F6JAWRPN.js";import{b as p,r as h,t as T}from"./chunk-UHRSAPGQ.js";import"./chunk-V76GWARL.js";import{a as z,b as D}from"./chunk-N2WTMF3X.js";var x=class extends n{constructor(){super(...arguments),this.type=null}};r([o({type:String,readOnly:!0,json:{write:{isRequired:!0}}})],x.prototype,"type",void 0),x=r([i("esri.layers.support.BuildingFilterAuthoringInfo")],x);var _=x;var L,v=L=class extends n{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new L({filterType:this.filterType,filterValues:p(this.filterValues)})}};r([o({type:String,json:{write:{isRequired:!0}}})],v.prototype,"filterType",void 0),r([o({type:[String],json:{write:{isRequired:!0}}})],v.prototype,"filterValues",void 0),v=L=r([i("esri.layers.support.BuildingFilterAuthoringInfoType")],v);var _e=v;var k,Ae=y.ofType(_e),I=k=class extends n{clone(){return new k({filterTypes:p(this.filterTypes)})}};r([o({type:Ae,json:{write:{isRequired:!0}}})],I.prototype,"filterTypes",void 0),I=k=r([i("esri.layers.support.BuildingFilterAuthoringInfoBlock")],I);var Ie=I;var q,Ee=y.ofType(Ie),b=q=class extends _{constructor(){super(...arguments),this.type="checkbox"}clone(){return new q({filterBlocks:p(this.filterBlocks)})}};r([o({type:["checkbox"]})],b.prototype,"type",void 0),r([o({type:Ee,json:{write:{isRequired:!0}}})],b.prototype,"filterBlocks",void 0),b=q=r([i("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],b);var N=b;var O=class extends n{};r([o({readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],O.prototype,"type",void 0),O=r([i("esri.layers.support.BuildingFilterMode")],O);var d=O;var P,j=P=class extends d{constructor(){super(...arguments),this.type="solid"}clone(){return new P}};r([o({type:["solid"],readOnly:!0,json:{write:{isRequired:!0}}})],j.prototype,"type",void 0),j=P=r([i("esri.layers.support.BuildingFilterModeSolid")],j);var B=j;var K,S=K=class extends d{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new K({edges:p(this.edges)})}};r([le({wireFrame:"wire-frame"})],S.prototype,"type",void 0),r([o(pe)],S.prototype,"edges",void 0),S=K=r([i("esri.layers.support.BuildingFilterModeWireFrame")],S);var V=S;var C,F=C=class extends d{constructor(){super(...arguments),this.type="x-ray"}clone(){return new C}};r([o({type:["x-ray"],readOnly:!0,json:{write:{isRequired:!0}}})],F.prototype,"type",void 0),F=C=r([i("esri.layers.support.BuildingFilterModeXRay")],F);var J=F;var U,Re={nonNullable:!0,types:{key:"type",base:d,typeMap:{solid:B,"wire-frame":V,"x-ray":J}},json:{read:e=>{switch(e?.type){case"solid":return B.fromJSON(e);case"wireFrame":return V.fromJSON(e);case"x-ray":return J.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}},g=U=class extends n{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new B,this.title=""}clone(){return new U({filterExpression:this.filterExpression,filterMode:p(this.filterMode),title:this.title})}};r([o({type:String,json:{write:{enabled:!0,isRequired:!0}}})],g.prototype,"filterExpression",void 0),r([o(Re)],g.prototype,"filterMode",void 0),r([o({type:String,json:{write:{enabled:!0,isRequired:!0}}})],g.prototype,"title",void 0),g=U=r([i("esri.layers.support.BuildingFilterBlock")],g);var Oe=g;var H,Me=y.ofType(Oe),c=H=class extends n{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=Z(),this.name=null}clone(){return new H({description:this.description,filterBlocks:p(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:p(this.filterAuthoringInfo)})}};r([o({type:String,json:{write:!0}})],c.prototype,"description",void 0),r([o({type:Me,json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"filterBlocks",void 0),r([o({types:{key:"type",base:_,typeMap:{checkbox:N}},json:{read:e=>e?.type==="checkbox"?N.fromJSON(e):null,write:!0}})],c.prototype,"filterAuthoringInfo",void 0),r([o({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"id",void 0),r([o({type:String,json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"name",void 0),c=H=r([i("esri.layers.support.BuildingFilter")],c);var je=c;var m=class extends n{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};r([o({type:String})],m.prototype,"fieldName",void 0),r([o({type:String})],m.prototype,"modelName",void 0),r([o({type:String})],m.prototype,"label",void 0),r([o({type:Number})],m.prototype,"min",void 0),r([o({type:Number})],m.prototype,"max",void 0),r([o({json:{read:e=>Array.isArray(e)&&(e.every(t=>typeof t=="string")||e.every(t=>typeof t=="number"))?e.slice():null}})],m.prototype,"mostFrequentValues",void 0),r([o({type:[Number]})],m.prototype,"subLayerIds",void 0),m=r([i("esri.layers.support.BuildingSummaryStatistics.BuildingFieldStatistics")],m);var w=class extends re.LoadableMixin(Y.EsriPromiseMixin(n)){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||this.loadStatus==="loading"?this._get("fields"):(h.getLogger(this).error("building summary statistics are not loaded"),null)}load(e){let t=e!=null?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Promise.resolve(this)}async _fetchService(e){let t=(await ee(this.url,{query:{f:"json"},responseType:"json",signal:e})).data;this.read(t,{origin:"service"})}};r([o({constructOnly:!0,type:String})],w.prototype,"url",void 0),r([o({readOnly:!0,type:[m],json:{read:{source:"summary"}}})],w.prototype,"fields",null),w=r([i("esri.layers.support.BuildingSummaryStatistics")],w);var $=w;var Be=y.ofType(je),Fe=p(f.sublayersProperty),G=Fe.json?.origins;G&&(G["web-scene"]={type:[E],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},G["portal-item"]={type:[E],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});var l=class extends be(me(ve(ye(ae(ie(ue(ne(xe)))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new de({getCollections:()=>[this.sublayers],getChildrenFunction:t=>t.type==="building-group"?t.sublayers:null}),this.sublayers=null,this._allSublayerOverrides=null,this.filters=new Be,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e??{}}destroy(){this.allSublayers.destroy()}readSublayers(e,t,s){let a=f.readSublayers(e,t,s);return f.forEachSublayer(a,u=>u.layer=this),this._allSublayerOverrides&&(Le(a,this._allSublayerOverrides),this._allSublayerOverrides=null),a}write(e,t){return e=super.write(e,t),!t||t.origin!=="web-scene"&&t.origin!=="portal-item"||(this.sublayers?qe(this.sublayers,e,t):this._allSublayerOverrides&&Ne(this._allSublayerOverrides,e,t)),e}read(e,t){if(super.read(e,t),(t?.origin==="web-scene"||t?.origin==="portal-item")&&Array.isArray(e?.sublayers)){let s=ke(e.sublayers,t);this.sublayers?Te(this.sublayers,s):(this._allSublayerOverrides??=new Map,this._allSublayerOverrides.set(t.origin,s))}}readSummaryStatistics(e,t){if(typeof t.statisticsHRef=="string"){let s=Q(this.parsedUrl?.path,t.statisticsHRef);return new $({url:s})}return null}set elevationInfo(e){e!=null&&e.mode!=="absolute-height"||this._set("elevationInfo",e),this._validateElevationInfo(e)}load(e){let t=e!=null?e.signal:null,s=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(X).then(()=>this._fetchService(t)).then(()=>this._fetchAssociatedFeatureService(t));return this.addResolvingPromise(s),Promise.resolve(this)}loadAll(){return te(this,e=>{f.forEachSublayer(this.sublayers,t=>{t.type!=="building-group"&&e(t)}),this.summaryStatistics&&e(this.summaryStatistics)})}async saveAs(e,t){return this._debouncedSaveOperations(R.SAVE_AS,D(z({},t),{getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"building-scene"}),e)}async save(){let e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"building-scene"};return this._debouncedSaveOperations(R.SAVE,e)}validateLayer(e){if(!e.layerType||e.layerType!=="Building")throw new T("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}async _fetchAssociatedFeatureService(e){try{let{portalItem:t}=await se(`${this.url}/layers/${this.layerId}`,{sceneLayerItem:this.portalItem,customParameters:this.customParameters,apiKey:this.apiKey,signal:e});this.associatedFeatureServiceItem=t}catch(t){h.getLogger(this).warn("Associated feature service item could not be loaded",t)}}_validateElevationInfo(e){let t="Building scene layers";M(h.getLogger(this),Se(t,"absolute-height",e)),M(h.getLogger(this),we(t,e))}};function Le(e,t){t.forEach(s=>Te(e,s))}function Te(e,t){let{overrides:s,context:a}=t;f.forEachSublayer(e,u=>u.read(s.get(u.id),a))}function ke(e,t){let s=new Map;for(let a of e)a!=null&&typeof a=="object"&&typeof a.id=="number"?s.set(a.id,a):t.messages?.push(new T("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:a}));return{overrides:s,context:t}}function qe(e,t,s){let a=[];f.forEachSublayer(e,u=>{let W=u.write({},s);Object.keys(W).length>1&&a.push(W)}),a.length>0&&(t.sublayers=a)}function Ne(e,t,s){let a=s?.origin&&e.get(s.origin);a&&(t.sublayers=[],a.overrides.forEach(u=>{t.sublayers.push(p(u))}))}r([o({type:["BuildingSceneLayer"]})],l.prototype,"operationalLayerType",void 0),r([o({readOnly:!0})],l.prototype,"allSublayers",void 0),r([o(Fe)],l.prototype,"sublayers",void 0),r([A("service","sublayers")],l.prototype,"readSublayers",null),r([o({type:Be,nonNullable:!0,json:{write:!0}})],l.prototype,"filters",void 0),r([o({type:String,json:{write:!0}})],l.prototype,"activeFilterId",void 0),r([o({readOnly:!0,type:$})],l.prototype,"summaryStatistics",void 0),r([A("summaryStatistics",["statisticsHRef"])],l.prototype,"readSummaryStatistics",null),r([o({type:[String],json:{read:!1}})],l.prototype,"outFields",void 0),r([o(ge)],l.prototype,"fullExtent",void 0),r([o(ce)],l.prototype,"legendEnabled",void 0),r([o({type:["show","hide","hide-children"]})],l.prototype,"listMode",void 0),r([o(he(oe))],l.prototype,"spatialReference",void 0),r([o(fe)],l.prototype,"elevationInfo",null),r([o({json:{read:!1},readOnly:!0})],l.prototype,"type",void 0),r([o()],l.prototype,"associatedFeatureServiceItem",void 0),l=r([i("esri.layers.BuildingSceneLayer")],l);var Oo=l;export{Oo as default};
