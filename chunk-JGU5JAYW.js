import{a as h,c as g}from"./chunk-EXJYW3PC.js";import{E as w}from"./chunk-ETE32IYO.js";import{K as d,v as p}from"./chunk-ONUGDWDK.js";import{y as b}from"./chunk-CKJ56T2Q.js";import{t as u}from"./chunk-UHRSAPGQ.js";import{a as y}from"./chunk-V76GWARL.js";import{a as i}from"./chunk-N2WTMF3X.js";var c=new Map;async function I(e,s){try{return{data:(await k(e,s)).data,baseUrl:d(e),styleUrl:e}}catch(r){return b(r),null}}function N(e,s,r){let t=s.portal!=null?s.portal:g.getDefault(),n,a=`${t.url} - ${t.user?.username} - ${e}`,o=c.get(a);if(o)return o;let f=R(e,t,r).then(l=>(n=l,l.fetchData())).then(l=>({data:l,baseUrl:n.itemUrl??"",styleName:e}));return c.set(a,f),f}function R(e,s,r){return s.load(r).then(()=>{let t=new h({disableExtraQuery:!0,query:`owner:${S} AND type:${U} AND typekeywords:"${e}"`});return s.queryItems(t,r)}).then(({results:t})=>{let n=null,a=e.toLowerCase();if(t&&Array.isArray(t)){for(let o of t)if(o.typeKeywords?.some(l=>l.toLowerCase()===a)&&o.type===U&&o.owner===S){n=o;break}}if(!n)throw new u("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(r)})}function T(e,s,r){return e?.styleUrl!=null?I(e.styleUrl,r):e?.styleName!=null?N(e.styleName,s,r):Promise.reject(new u("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function v(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function F(e,s){for(let r of s)switch(r){case"cim":if(e.cimRef)return{format:r,url:encodeURI(e.cimRef)};break;case"web-gltf-basisu":{let t=m(e,"gltf_basisu");if(t)return{format:r,url:t};break}case"web-gltf":{let t=m(e,"gltf");if(t)return{format:r,url:t};break}case"web":{let t=m(e,"gltf");if(t)return{format:"web-gltf",url:t};if(e.webRef)return{format:r,url:encodeURI(e.webRef)};break}}}function m(e,s){if(!y("enable-feature:force-wosr"))return e.formatInfos?.find(r=>r.type===s)?.href}function k(e,s){let r=i({responseType:"json",query:{f:"json"}},s);return w(p(e),r)}var S="esri_en",U="Style",L="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{T as a,v as b,F as c,k as d,L as e};
