import{E as p}from"./chunk-ETE32IYO.js";import{a as u,b as f,c as l}from"./chunk-N2WTMF3X.js";async function o(e,t){let{data:r}=await p(e,{responseType:"json",query:f(u({f:"json"},t?.customParameters),{token:t?.apiKey})});return r}var h=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function I(e,t){let i=t||{},{loadContext:r}=i,a=l(i,["loadContext"]),n=r?await r.fetchServiceMetadata(e,a):await o(e,a);S(n),L(n);let s={serviceJSON:n};if((n.currentVersion??0)<10.5)return s;let y=`${e}/layers`,c=r?await r.fetchServiceMetadata(y,a):await o(y,a);return S(c),L(c),s.layersJSON={layers:c.layers,tables:c.tables},s}function m(e){let{type:t}=e;return!!t&&h.has(t)}function b(e){return e.type==="Table"}function L(e){e.layers=e.layers?.filter(m),e.tables=e.tables?.filter(b)}function d(e){e.type||="Feature Layer"}function g(e){e.type||="Table"}function S(e){e.layers?.forEach(d),e.tables?.forEach(g)}function T(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}export{o as a,I as b,T as c};
