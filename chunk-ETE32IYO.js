import{A as x,J as pe,N as J,O as j,Q as V,R as fe,S as H,U as Y,b as ie,c as W,f as S,h as q,i as le,j as B,k as ce,m as ue,n as de,q as z,r as O,s as I,t as R,u as G,v as D,w as me,x as m,y as N,z as Q}from"./chunk-ONUGDWDK.js";import{i as ne}from"./chunk-WZDN6K3C.js";import{A as oe,D as ae,u as P,x as C}from"./chunk-CKJ56T2Q.js";import{b as se,k as y,t as L}from"./chunk-UHRSAPGQ.js";import{a as h}from"./chunk-V76GWARL.js";import{a as v}from"./chunk-N2WTMF3X.js";var Fe="20250407",_e="04d2b42da93678ca718b23aaf7e216985f10fa8e";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");var Me="4.32",d,$e=Me;$e="4.32.10";function pr(r){d=r}function fr(r){let e=d?.findCredential(r);return e?.token?fe(r,"token",e.token):r}h("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),h("host-webworker");function he(r,e){let t=e?.url?.path;if(r&&t&&(r=R(r,t,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){let s=G(r,e.portalItem.itemUrl);s!=null&&We.test(s)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(s).path)}return(r=X(r,e?.portal))&&F.test(r)?we(r):r}function ge(r,e,t=k.YES){if((r=r&&F.test(r)?ve(r):r)==null)return r;!N(r)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(r);let s=R(r);if(e){let o=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(o){let a=X(o,e.portal),i=X(s,e.portal);s=G(i,a,a),s!=null&&s!==i&&s!==r&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(s)}}return s=ye(s,e?.portal),N(s)&&(s=D(s)),e?.resources&&e?.portalItem&&!N(s)&&!x(s)&&t===k.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(s),compress:!1}),s}function Ke(r,e,t){return he(r,t)}function Z(r,e,t,s){let o=ge(r,s);o!==void 0&&(e[t]=o)}var F=/\/items\/([^/]+)\/resources\/(.*)/,We=/^\.\/resources\//;function Be(r){return(r?.match(F)??null)?.[1]??null}function ze(r){let e=r?.match(F)??null;if(e==null)return null;let t=e[2],s=t.lastIndexOf("/");if(s===-1){let{path:i,extension:n}=Y(t);return{prefix:null,filename:i,extension:n}}let{path:o,extension:a}=Y(t.slice(s+1));return{prefix:t.slice(0,s),filename:o,extension:a}}function ye(r,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?j(r,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):r}function X(r,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return r;let t=`${e.urlKey}.${e.customBaseUrl}`,s=S();return O(s,`${s.scheme}://${t}`)?j(r,e.portalHostname,t):j(r,t,e.portalHostname)}function we(r){if(!r)return r||null;let e=r;return e&&d&&!d.findCredential(e)&&(e=W(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function ve(r){if(!r)return r||null;let e=r;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&d&&!d.findCredential(e)&&(e=W(e)),e}var k;(function(r){r[r.YES=0]="YES",r[r.NO=1]="NO"})(k||(k={}));var br=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return k},ensureMainOnlineDomain:ye,fromCDNUrl:ve,fromJSON:he,itemIdFromResourceUrl:Be,prefixAndFilenameFromResourceUrl:ze,read:Ke,toCDNUrl:we,toJSON:ge,write:Z},Symbol.toStringTag,{value:"Module"}));var be={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Se=Object.values(be),qe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Se.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),Ge=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Se.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),Qe=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Cr(r){return qe.test(r)}function Oe(r){if(r==null)return null;let e=q(r),t=e?.path.match(qe)||e?.path.match(Ge);if(!t)return null;let[,s,o,a,i]=t,n=o.indexOf("/");return{title:Te(n!==-1?o.slice(n+1):o),serverType:be[a.toLowerCase()],sublayer:i!=null&&i!==""?parseInt(i,10):null,url:{path:s}}}function Je(r){let e=q(r).path.match(Qe);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Te(r){return(r=r.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+r.slice(1)}function xr(r,e){let t=[];if(r){let s=Oe(r);s!=null&&s.title&&t.push(s.title)}if(e){let s=Te(e);t.push(s)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function ee(r){let e=m(r,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function kr(r,e){return r&&J(V(r,e))}function Ur(r){let{url:e}=r;if(!e)return{url:e};e=V(e,r.logger);let t=q(e),s=Oe(t.path),o;if(s!=null)s.sublayer!=null&&r.layer.layerId==null&&(o=s.sublayer),e=s.url.path;else if(r.nonStandardUrlAllowed){let a=Je(t.path);a!=null&&(e=a.serviceUrl,o=a.sublayerId)}return{url:J(e),layerId:o}}function Ar(r,e,t,s,o){Z(e,s,"url",o),s.url&&r.layerId!=null&&(s.url=me(s.url,t,r.layerId.toString()))}function Er(r){if(!r)return!1;let e=r.toLowerCase(),t=e.includes("/services/"),s=e.includes("/mapserver/wmsserver"),o=e.includes("/imageserver/wmsserver"),a=e.includes("/wmsserver");return t&&(s||o||a)}var Ve=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function Ye(r){let e=m(r,!0);return!!e&&e.endsWith(".arcgis.com")&&!Ve.has(e)&&!r.endsWith("/sharing/rest/generateToken")}function Ce(r,e){return!(!e&&!y.apiKey||!Ye(r))}function ke(r,e,t=!1,s){return new Promise((o,a)=>{if(C(s))return void a(xe());let i=()=>{l(),a(new Error(`Unable to load ${e}`))},n=()=>{let p=r;l(),o(p)},c=()=>{if(!r)return;let p=r;l(),p.src="",a(xe())},l=()=>{h("esri-image-decode")||(r.removeEventListener("error",i),r.removeEventListener("load",n)),i=null,n=null,r=null,s?.removeEventListener("abort",c),c=null,t&&URL.revokeObjectURL(e)};s?.addEventListener("abort",c),h("esri-image-decode")?r.decode().then(n,i):(r.addEventListener("error",i),r.addEventListener("load",n))})}function xe(){try{return new DOMException("Aborted","AbortError")}catch{let r=new Error;return r.name="AbortError",r}}var Ue="Timeout exceeded";function Ae(){return new Error(Ue)}function Fr(r){return typeof r=="object"&&!!r&&"message"in r&&r.message===Ue}function Ee(r){y.request.crossOriginNoCorsDomains||(y.request.crossOriginNoCorsDomains={});let e=y.request.crossOriginNoCorsDomains;for(let t of r)t=t.toLowerCase(),/^https?:\/\//.test(t)?e[m(t)??""]=0:(e[m("http://"+t)??""]=0,e[m("https://"+t)??""]=0)}function Le(r){let e=y.request.crossOriginNoCorsDomains;if(e){let t=m(r);if(t)return t=t.toLowerCase(),!O(t,S())&&e[t]<Date.now()-36e5}return!1}async function Pe(r){let e=q(r);r=e.path,e.query?.f==="json"&&(r+="?f=json");try{await fetch(r,{mode:"no-cors",credentials:"include"})}catch{}let t=y.request.crossOriginNoCorsDomains,s=m(r);t&&s&&(t[s.toLowerCase()]=Date.now())}async function b(r,e){r instanceof URL&&(r=r.toString()),e?.query instanceof URLSearchParams&&(e.query=le(e.query.toString().replaceAll("+"," ")));let t=x(r),s=Q(r);s||t||(r=D(r));let o={url:r,requestOptions:v({},e)},a=f=>({data:f,getAllHeaders:T,getHeader:T,httpStatus:200,requestOptions:o.requestOptions,url:o.url}),i=z(r,g.internalInterceptors);if(i){let f=await Re(i,o);if(f!=null)return a(f)}let n=z(r);if(n){let f=await Re(n,o);if(f!=null)return a(f);n.after||n.error||(n=null)}if(r=o.url,(e=o.requestOptions).responseType==="image"&&(h("host-webworker")||h("host-node")))throw w("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),o);if(e.method==="head"){if(e.body)throw w("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),o);if(t||s)throw w("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),o)}if(await tr(),_)return _.execute(r,e);let c=new AbortController,l=oe(e,()=>c.abort()),p={controller:c,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:n,params:o,redoRequest:!1,useIdentity:g.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},U=e.useRequestQueue?ir(p):te(p),u=await U.finally(()=>l?.remove());return n?.after?.(u),u}var _,g=y.request,je="FormData"in globalThis,Xe=new Set([499,498,403,401]),Ze=new Set(["COM_0056","COM_0057","SB_0008"]),er=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],T=()=>null,M=Symbol();function rr(r){let e=m(r);e&&!b._corsServers.includes(e)&&b._corsServers.push(e)}function Ie(r){let e=m(r);return!e||e.endsWith(".arcgis.com")||b._corsServers.includes(e)||I(e)}function w(r,e,t,s){let o="Error",a={url:t.url,requestOptions:t.requestOptions,getAllHeaders:T,getHeader:T,ssl:!1};if(e instanceof L)return e.details?(e.details=se(e.details),e.details.url=t.url,e.details.requestOptions=t.requestOptions):e.details=a,e;if(e){let i=s&&(()=>Array.from(s.headers)),n=s&&(p=>s.headers.get(p)),c=s?.status,l=e.message;l&&(o=l),i&&n&&(a.getAllHeaders=i,a.getHeader=n),a.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||c||0,a.subCode=e.subcode,a.messageCode=e.messageCode,typeof e.details=="string"?a.messages=[e.details]:a.messages=e.details,a.raw=M in e?e[M]:e}return ae(e)?P():new L(r,o,a)}async function tr(){h("host-webworker")&&!_&&(_=await import("./chunk-LGTO4EE2.js"))}async function re(){d||await import("./chunk-MYC5OGLQ.js")}async function sr(r){let e=r.params.url,t=r.params.requestOptions,s=r.controller.signal,o=t.body,a=null,i=null;if(je&&"HTMLFormElement"in globalThis&&(o instanceof FormData?a=o:o instanceof HTMLFormElement&&(a=new FormData(o))),typeof o=="string"&&(i=o),r.fetchOptions={cache:t.cacheBust?"no-cache":"default",credentials:"same-origin",headers:t.headers||{},method:t.method==="head"?"HEAD":"GET",mode:"cors",priority:g.priority,redirect:"follow",signal:s},(a||i)&&(r.fetchOptions.body=a||i),t.authMode==="anonymous"&&(r.useIdentity=!1),r.hasToken=!!(/token=/i.test(e)||t.query?.token||a?.get("token")),!r.hasToken&&Ce(e)&&(t.query||(t.query={}),t.query.token=y.apiKey,r.hasToken=!0),r.useIdentity&&!r.hasToken&&!r.credentialToken&&!He(e)&&!C(s)){let n;t.authMode==="immediate"?(await re(),n=await d.getCredential(e,{signal:s}),r.credential=n):t.authMode==="no-prompt"?(await re(),n=await d.getCredential(e,{prompt:!1,signal:s}).catch(()=>{}),r.credential=n):d&&(n=d.findCredential(e)),n&&(r.credentialToken=n.token,r.useSSL=!!n.ssl)}}function He(r){return er.some(e=>e.test(r))}async function or(r){let e=r.params.url,t=r.params.requestOptions,s=r.fetchOptions??{},o=Q(e)||x(e),a=t.responseType||"json",i=o?0:t.timeout!=null?t.timeout:g.timeout,n=!1;if(!o){r.useSSL&&(e=pe(e));let u=v({},t.query);r.credentialToken&&(u.token=r.credentialToken);let f=B(u);h("esri-url-encodes-apostrophe")&&(f=f.replaceAll("'","%27"));let $=e.length+1+f.length,K;n=t.method==="delete"||t.method==="post"||t.method==="put"||!!t.body||$>g.maxUrlLength;let A=t.useProxy||!!de(e);if(A){let E=ce(e);K=E.path,!n&&K.length+1+$>g.maxUrlLength&&(n=!0),E.query&&(u=v(v({},E.query),u))}if(s.method==="HEAD"&&(n||A)){if(n)throw $>g.maxUrlLength?w("request:invalid-parameters",new Error("URL exceeds maximum length"),r.params):w("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),r.params);if(A)throw w("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),r.params)}n?(s.method=t.method==="delete"?"DELETE":t.method==="put"?"PUT":"POST",t.body?e=H(e,u):(s.body=B(u),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=H(e,u),A&&(r.useProxy=!0,e=`${K}?${e}`),u.token&&je&&s.body instanceof FormData&&!ie(e)&&s.body.set("token",u.token),t.hasOwnProperty("withCredentials")?r.withCredentials=t.withCredentials:O(e,S())||(I(e)||d&&d.findServerInfo(e)?.webTierAuth)&&(r.withCredentials=!0),r.withCredentials&&(s.credentials="include",Le(e)&&await Pe(n?H(e,u):e))}let c,l,p=0,U=!1;i>0&&(p=setTimeout(()=>{U=!0,r.controller.abort()},i));try{if(t.responseType==="native-request-init")l=s,l.url=e,t.signal?l.signal=t.signal:delete l.signal;else if(t.responseType!=="image"||s.cache!=="default"||s.method!=="GET"||n||ar(t.headers)||!o&&!r.useProxy&&g.proxyUrl&&!Ie(e)){if(b._beforeFetch&&await b._beforeFetch(e,s),c=await fetch(e,s),b._afterFetch&&await b._afterFetch(c),r.useProxy||rr(e),t.responseType==="native")l=c;else if(s.method!=="HEAD")if(c.ok){switch(a){case"array-buffer":l=await c.arrayBuffer();break;case"blob":case"image":l=await c.blob();break;default:l=await c.text()}if(p&&(clearTimeout(p),p=0),a==="json"||a==="xml"||a==="document")if(l)switch(a){case"json":l=JSON.parse(l);break;case"xml":l=De(l,"application/xml");break;case"document":l=De(l,"text/html")}else l=null;if(l){if(a==="array-buffer"||a==="blob"){let u=c.headers.get("Content-Type");if(u&&/application\/json|text\/plain/i.test(u)&&l[a==="blob"?"size":"byteLength"]<=750)try{let f=await new Response(l).json();f.error&&(l=f)}catch{}}a==="image"&&l instanceof Blob&&(l=await Ne(URL.createObjectURL(l),r,!0))}}else{l=await c.text();try{l=JSON.parse(l)}catch{}}}else l=await Ne(e,r)}catch(u){if(u.name==="AbortError")throw U?Ae():P("Request canceled");if(!(!c&&u instanceof TypeError&&g.proxyUrl)||t.body||t.method==="delete"||t.method==="head"||t.method==="post"||t.method==="put"||r.useProxy||Ie(e))throw u;r.redoRequest=!0,ue({proxyUrl:g.proxyUrl,urlPrefix:m(e)??""})}finally{p&&clearTimeout(p)}return[c,l]}async function Re(r,e){if(r.responseData!=null)return r.responseData;if(r.headers&&(e.requestOptions.headers=v(v({},e.requestOptions.headers),r.headers)),r.query&&(e.requestOptions.query=v(v({},e.requestOptions.query),r.query)),r.before){let t,s;try{s=await r.before(e)}catch(o){t=w("request:interceptor",o,e)}if((s instanceof Error||s instanceof L)&&(t=w("request:interceptor",s,e)),t)throw r.error&&r.error(t),t;return s}}function ar(r){if(r){for(let e of Object.getOwnPropertyNames(r))if(r[e])return!0}return!1}function De(r,e){let t;try{t=new DOMParser().parseFromString(r,e)}catch{}if(!t||t.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return t}b._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],b._beforeFetch=void 0,b._afterFetch=void 0;var nr=new Map;async function ir(r){let e=cr(r.params.url);if(!e)return te(r);let{QueueProcessor:t}=await import("./chunk-S4SPGMF7.js");return ne(nr,e.origin,()=>{let o=e.isHosted?h("request-queue-concurrency-hosted"):h("request-queue-concurrency-non-hosted");return new t({concurrency:o,process:a=>{if(C(a.params.requestOptions))throw w("",P("Request canceled"),a.params);return te(a)}})}).push(r)}async function te(r){let e,t;await sr(r);try{do[e,t]=await or(r);while(!await lr(r,e,t))}catch(a){let i=w("request:server",a,r.params,e);throw i.details.ssl=r.useSSL,r.interceptor?.error&&r.interceptor.error(i),i}let s=r.params.url;if(t&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(s)){if(!r.hasToken&&!r.credentialToken&&t.user?.username&&!I(s)){let a=m(s,!0);a&&g.trustedServers.push(a)}Array.isArray(t.authorizedCrossOriginNoCorsDomains)&&Ee(t.authorizedCrossOriginNoCorsDomains)}let o=r.credential;if(o&&d){let i=d.findServerInfo(o.server)?.owningSystemUrl;if(i){i=i.replace(/\/?$/,"/sharing");let n=d.findCredential(i,o.userId);n&&d._getIdenticalSvcIdx(i,n)===-1&&n.resources.unshift(i)}}return{data:t,getAllHeaders:e?()=>Array.from(e.headers):T,getHeader:e?a=>e.headers.get(a):T,httpStatus:e?.status??200,requestOptions:r.params.requestOptions,ssl:r.useSSL,url:r.params.url}}async function lr(r,e,t){if(r.redoRequest)return r.redoRequest=!1,!1;let s=r.params.requestOptions;if(!e||s.responseType==="native"||s.responseType==="native-request-init")return!0;let o,a;if(t&&(t.error&&typeof t.error=="object"?o=t.error:t.status==="error"&&Array.isArray(t.messages)&&(o=v({},t),o[M]=t,o.details=t.messages)),!o&&!e.ok)throw o=new Error(`Unable to load ${e.url} status: ${e.status}`),o[M]=t,o;let i,n=null;o&&(a=Number(o.code),n=o.hasOwnProperty("subcode")?Number(o.subcode):null,i=o.messageCode,i=i?.toUpperCase());let c=s.authMode;if(a===403&&(n===4||o.message?.toLowerCase().includes("ssl")&&!o.message.toLowerCase().includes("permission"))){if(!r.useSSL)return r.useSSL=!0,!1}else if(!r.hasToken&&r.useIdentity&&(c!=="no-prompt"||a===498)&&a!==void 0&&Xe.has(a)&&!He(r.params.url)&&(a!==403||(!i||!Ze.has(i))&&(n==null||n===2&&r.credentialToken))){await re();try{let l=await d.getCredential(r.params.url,{error:w("request:server",o,r.params),prompt:c!=="no-prompt",signal:r.controller.signal,token:r.credentialToken});return r.credential=l,r.credentialToken=l.token,r.useSSL=r.useSSL||l.ssl,!1}catch(l){if(c==="no-prompt")return r.credential=void 0,r.credentialToken=void 0,!1;o=l}}if(o)throw o;return!0}function Ne(r,e,t=!1){let s=e.controller.signal,o=new Image;return e.withCredentials?o.crossOrigin="use-credentials":o.crossOrigin="anonymous",o.alt="",o.fetchPriority=g.priority,o.src=r,ke(o,r,t,s)}function cr(r){let e,t;return typeof r=="string"?(e=m(r,!0),t=ee(r)):(e=r.origin,t=ee(r.toString())),e==null?null:{origin:e,isHosted:t}}export{Fe as a,_e as b,Me as c,d,$e as e,pr as f,fr as g,he as h,ge as i,Ke as j,Z as k,Be as l,ze as m,ye as n,we as o,k as p,br as q,Cr as r,Oe as s,Je as t,Te as u,xr as v,ee as w,kr as x,Ur as y,Ar as z,Er as A,Ce as B,ke as C,Fr as D,b as E};
