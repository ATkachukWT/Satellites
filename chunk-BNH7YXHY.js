import{E as w}from"./chunk-ETE32IYO.js";import{T as g,w as u}from"./chunk-ONUGDWDK.js";import{t as h}from"./chunk-UHRSAPGQ.js";async function S(e,t={},s){await e.load(s);let r=u(e.itemUrl,"resources"),{start:a=1,num:d=10,sortOrder:n="asc",sortField:f="resource"}=t,i={query:{start:a,num:d,sortOrder:n,sortField:f,token:e.apiKey},signal:s?.signal},o=await e.portal.request(r,i);return{total:o.total,nextStart:o.nextStart,resources:o.resources.map(({created:m,size:c,resource:l})=>({created:new Date(m),size:c,resource:e.resourceFromPath(l)}))}}async function O(e,t,s,r){let a=new Map;for(let{resource:n,content:f,compress:i,access:o}of t){if(!n.hasPath())throw new h(`portal-item-resource-${s}:invalid-path`,"Resource does not have a valid path");let[m,c]=y(n.path),l=`${m}/${i??""}/${o??""}`;a.has(l)||a.set(l,{prefix:m,compress:i,access:o,files:[]}),a.get(l).files.push({fileName:c,content:f})}await e.load(r);let d=u(e.userItemUrl,s==="add"?"addResources":"updateResources");for(let{prefix:n,compress:f,access:i,files:o}of a.values())for(let c=0;c<o.length;c+=25){let l=o.slice(c,c+25),p=new FormData;n&&n!=="."&&p.append("resourcesPrefix",n),f&&p.append("compress","true"),i&&p.append("access",i);let b=0;for(let{fileName:x,content:P}of l)p.append("file"+ ++b,P,x);p.append("f","json"),await e.portal.request(d,{method:"post",body:p,signal:r?.signal})}}async function j(e,t,s){if(!t.hasPath())throw new h("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(s);let r=u(e.userItemUrl,"removeResources");await e.portal.request(r,{method:"post",query:{resource:t.path},signal:s?.signal}),t.portalItem=null}async function U(e,t){await e.load(t);let s=u(e.userItemUrl,"removeResources");return e.portal.request(s,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function y(e){let t=e.lastIndexOf("/");return t===-1?[".",e]:[e.slice(0,t),e.slice(t+1)]}function v(e){let[t,s]=R(e),[r,a]=y(t);return[r,a,s]}function R(e){let t=g(e);return t==null?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function $(e){return e.type==="blob"?e.blob:e.type==="json"?new Blob([e.jsonString],{type:"application/json"}):(await w(e.url,{responseType:"blob"})).data}function T(e,t){if(!e.hasPath())return null;let[s,,r]=v(e.path);return e.portalItem.resourceFromPath(u(s,t+r))}function A(e,t){if(!e.hasPath())return null;let[s,,r]=v(e.path);return e.portalItem.resourceFromPath(u(s,t+r))}export{S as a,O as b,j as c,U as d,v as e,$ as f,T as g,A as h};
