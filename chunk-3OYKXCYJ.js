import{d as I}from"./chunk-ULANM5YP.js";import{a as g}from"./chunk-NHEQ4TAR.js";import{b as h,g as w}from"./chunk-BIRSPTTF.js";import{F as C}from"./chunk-HP4LYRR4.js";import{b as d}from"./chunk-NSYL2RQJ.js";var F=/^-?(\d+)(\.(\d+))?$/i;function N(e,t){return e-t}function M(e,t){let n,i;return n=Number(e.toFixed(t)),n<e?i=n+1/10**t:(i=n,n-=1/10**t),n=Number(n.toFixed(t)),i=Number(i.toFixed(t)),[n,i]}function v(e,t,n,i,a){let o=R(e,t,n,i),r=o.previous==null||o.previous<=a,l=o.next==null||o.next<=a;return r&&l||o.previous+o.next<=2*a}function b(e){let t=String(e),n=t.match(F);if(n?.[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(t.toLowerCase().includes("e")){let i=t.split("e"),a=i[0],o=i[1];if(a&&o){let r=Number(a),l=Number(o),s=l>0;s||(l=Math.abs(l));let A=b(r);return s?(A.integer+=l,l>A.fractional?A.fractional=0:A.fractional-=l):(A.fractional+=l,l>A.integer?A.integer=1:A.integer-=l),A}}return{integer:0,fractional:0}}function R(e,t,n,i){let a={previous:null,next:null};if(n!=null){let o=e-n,r=t-n-o;a.previous=Math.floor(Math.abs(100*r/o))}if(i!=null){let o=i-e,r=i-t-o;a.next=Math.floor(Math.abs(100*r/o))}return a}function O(e,t={}){let n=e.slice(),{tolerance:i=2,strictBounds:a=!1,indexes:o=n.map((r,l)=>l)}=t;o.sort(N);for(let r=0;r<o.length;r++){let l=o[r],s=n[l],A=l===0?null:n[l-1],U=l===n.length-1?null:n[l+1],m=b(s).fractional;if(m){let u,f=0,c=!1;for(;f<=m&&!c;){let p=M(s,f);u=a&&r===0?p[1]:p[0],c=v(s,u,A,U,i),f++}c&&(n[l]=u)}}return n}var T={maximumFractionDigits:20};function V(e){return d(e,T)}var y="<",B=">";function j(e,t,n,i){let a="";return t===0?a=`${y} `:t===n&&(a=`${B} `),a+(i?w(e,i):V(e))}var z=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function E(e){if(!("visualVariables"in e)||!e.visualVariables)return null;let t=e.visualVariables.find(r=>r.type==="color");if(!t)return null;let n=null,i=null;if(t.stops){if(t.stops.length===1)return t.stops[0].color;n=t.stops[0].value,i=t.stops[t.stops.length-1].value}let a=n!=null&&i!=null?n+(i-n)/2:0,{getColor:o}=await import("./chunk-E55JLOAL.js");return o(t,a)??null}async function H(e,t){let n=e.trailCap,i=e.trailWidth||1,a=t||await E(e)||e.color;return new I({cap:n,color:a,width:i})}function x(e,t){if(!t.field)return null;if("featureReduction"in e)switch(e.featureReduction?.type){case"cluster":case"binning":{let n=e.featureReduction.fields.find(({name:i})=>i.toLowerCase()===t.field.toLowerCase());return n&&"getField"in e?e.getField(n.onStatisticField):null}}return"getField"in e?e.getField?.(t.field):null}function Q(e,t){let n="popupTemplate"in e?e.popupTemplate?.fieldInfos:null;if(n?.length&&t)return n.find(i=>i.fieldName?.toLowerCase()===t.toLowerCase())?.format?.dateFormat}function Z(e,t,n){let i=x(e,t);if(!i||!h(i)&&!C(i))return null;let a=Q(e,i.name);if(!a&&i.type==="date"){let o=0,r=0;t.stops?(o=t.stops?.at(0)?.value??o,r=t.stops?.at(-1)?.value??r):"minDataValue"in t&&"maxDataValue"in t&&(o=t.minDataValue??o,r=t.maxDataValue??r),a=r-o>2*g.days?"short-date":"short-date-short-time"}return{fieldType:i.type,format:a,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in e?e.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone}}}function X(e){if("authoringInfo"in e)return e.authoringInfo?.visualVariables?.find(({theme:t})=>t==="reference-size")}export{b as a,R as b,O as c,y as d,B as e,j as f,z as g,E as h,H as i,Z as j,X as k};
