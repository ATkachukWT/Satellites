import{a as A}from"./chunk-YHWE4TIZ.js";import{a as F,b as d}from"./chunk-QSMPW36A.js";import{a as T,b as g,c as $,d as w,e as j}from"./chunk-JGU5JAYW.js";import{f as h}from"./chunk-LCMPSAU3.js";import{A as E,m as c,n as S}from"./chunk-I4Q2S2XA.js";import{c as N}from"./chunk-EXJYW3PC.js";import{h as b}from"./chunk-ETE32IYO.js";import{K as p,h as f}from"./chunk-ONUGDWDK.js";import{t as u}from"./chunk-UHRSAPGQ.js";function Y(t,e,l){let o=t.name;return o==null?Promise.reject(new u("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?C(o,e,l):T(t,e,l).then(a=>x(a,o,e,$,l))}function q(t,e){return e.items.find(l=>l.name===t)}async function x(t,e,l,o,a){let m=l?.portal!=null?l.portal:N.getDefault(),n={portal:m,url:f(t.baseUrl),origin:"portal-item"},s=q(e,t.data);if(!s)throw new u("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});let U=a?.acceptedFormats??A,D=o(s,U);if(!D)throw new u("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${U})`,{symbolName:e});let{url:I,format:P}=D,i=b(I,n),y=s.thumbnail?.href??null,O=s.thumbnail?.imageData;F()&&(i=d(i)??"",y=d(y));let J={portal:m,url:f(p(i)),origin:"portal-item"};return w(i,a).then(v=>{let M=P==="cim"?g(v.data):v.data,r=h(M,J);if(r&&E(r)){if(y){let k=b(y,n);r.thumbnail=new S({url:k})}else O&&(r.thumbnail=new S({url:`data:image/png;base64,${O}`}));t.styleUrl?r.styleOrigin=new c({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(r.styleOrigin=new c({portal:l.portal,styleName:t.styleName,name:e}))}return r})}function C(t,e,l){let o=j.replaceAll(/\{SymbolName\}/gi,t),a=e.portal!=null?e.portal:N.getDefault();return w(o,l).then(m=>{let n=g(m.data);return h(n,{portal:a,url:f(p(o)),origin:"portal-item"})})}export{Y as a,q as b,x as c};
