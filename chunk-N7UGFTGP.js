import{a as C,b as A}from"./chunk-AY7CYY2N.js";import"./chunk-VEK547EU.js";import"./chunk-LAVD467M.js";import"./chunk-6CUAH7AI.js";import"./chunk-OC2XJJQU.js";import{a as V}from"./chunk-4OC4J3KU.js";import"./chunk-54HXR2K7.js";import{r as E}from"./chunk-T4QAGZWF.js";import"./chunk-7BXTHPPE.js";import"./chunk-Q5KIWWVU.js";import"./chunk-KK722UJA.js";import"./chunk-C27Q2S3P.js";import{a as c,b,c as h}from"./chunk-HATZI22X.js";import"./chunk-ZFRNSCYG.js";import"./chunk-UWWX7VSW.js";import"./chunk-CFF33S4D.js";import{q as F}from"./chunk-2XYAAYOE.js";import"./chunk-NIYDRLW4.js";import"./chunk-CAXK5KYB.js";import"./chunk-3CCK7BDD.js";import"./chunk-LNYBTIG7.js";import"./chunk-AOQ57NDM.js";import"./chunk-VMECOA4F.js";import"./chunk-JPMGMA4B.js";import"./chunk-DJW5LMRG.js";import"./chunk-ALWV3RJ2.js";import"./chunk-DEH76MSI.js";import"./chunk-VTGWQ7AP.js";import"./chunk-TBA3OZMJ.js";import"./chunk-S4QV2MGO.js";import"./chunk-USMAJP2P.js";import"./chunk-PHNFWHVF.js";import"./chunk-4N5OXIEM.js";import"./chunk-W26XKMAT.js";import"./chunk-NQWYPF77.js";import"./chunk-JTDXB5TK.js";import"./chunk-CWUY5SXW.js";import"./chunk-GWBRHLNH.js";import"./chunk-EM35R6FY.js";import"./chunk-QXXXCEV5.js";import"./chunk-6B5XFA6F.js";import"./chunk-NHEQ4TAR.js";import{b as _}from"./chunk-AFC2H4Q3.js";import"./chunk-ZTOZWLEE.js";import"./chunk-NRBJLISB.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-FENRIY2T.js";import"./chunk-5HJY3X5Y.js";import"./chunk-6RZAM42M.js";import"./chunk-JGEVVXD4.js";import"./chunk-B3FO6PT7.js";import"./chunk-C4UMJHQC.js";import"./chunk-BCREO4Q5.js";import"./chunk-LXFQWIWE.js";import"./chunk-QT6UNBJP.js";import{a as u,c as S,i as g}from"./chunk-MWSXMSWY.js";import"./chunk-JRCKELO6.js";import"./chunk-KJULKTB5.js";import"./chunk-LACL4BQ2.js";import"./chunk-YR2HD3ZC.js";import"./chunk-GJASVPF6.js";import"./chunk-UBFCO3DV.js";import"./chunk-NI7FJV5X.js";import"./chunk-BUSG3ZOF.js";import"./chunk-XZIOXVVJ.js";import"./chunk-LFH24RLM.js";import"./chunk-Z5Q7KLA4.js";import"./chunk-X4LNX4BR.js";import"./chunk-4XZ6X7MQ.js";import"./chunk-WLHY3MMA.js";import"./chunk-KGVXGH6H.js";import"./chunk-ARRCN5K3.js";import"./chunk-FTDD7QBB.js";import"./chunk-DB3UIQCU.js";import"./chunk-SBHKMV3P.js";import"./chunk-R4A63S45.js";import"./chunk-ETE32IYO.js";import"./chunk-ONUGDWDK.js";import"./chunk-SG7CQU4O.js";import{H as o,J as w}from"./chunk-QHVIRF5H.js";import{I as f}from"./chunk-WZDN6K3C.js";import{a as n}from"./chunk-QGVBCWUY.js";import"./chunk-OJQ73TPF.js";import"./chunk-354SCPDU.js";import"./chunk-OVHPPCBL.js";import"./chunk-IYZFKXJ6.js";import{C as v,v as s}from"./chunk-CKJ56T2Q.js";import"./chunk-SNFOAZZQ.js";import"./chunk-F6JAWRPN.js";import"./chunk-UHRSAPGQ.js";import"./chunk-V76GWARL.js";import"./chunk-N2WTMF3X.js";var r=class extends w{get availability(){return 1}get _snappingElevationAligner(){let{view:e}=this,{layer:t}=this.layerSource,i=e!=null&&e.type==="3d";if(!i||t.type==="subtype-group")return c();let a=async(l,p)=>(await v(e.whenLayerView(t),p)).elevationAlignPointsInFeatures(l,p);return c(i,{elevationInfo:t.elevationInfo,alignPointsInFeatures:a})}get _snappingElevationFilter(){let{view:e}=this,t=e!=null&&e.type==="3d"&&this.layerSource.layer.type!=="subtype-group";return b(t)}get _symbologySnappingFetcher(){let{view:e}=this,{layer:t}=this.layerSource;return e!=null&&e.type==="3d"&&t.type!=="subtype-group"?h(this._symbologySnappingSupported,async(i,a)=>{let l=await e.whenLayerView(t);return s(a),l.queryForSymbologySnapping({candidates:i,spatialReference:e.spatialReference},a)}):h()}get _layerView(){let{view:e}=this;if(e==null)return null;let{layer:t}=this.layerSource;return e.allLayerViews.find(i=>i.layer===t)}get _layerView3D(){let{view:e}=this;return e==null||e.type==="2d"?null:this._layerView}get _symbologySnappingSupported(){return this._layerView3D!=null&&this._layerView3D.symbologySnappingSupported}initialize(){let{view:e}=this,{layer:t}=this.layerSource;e!=null&&e.type==="3d"&&t.type!=="subtype-group"&&this.addHandles([e.elevationProvider.on("elevation-change",({context:i})=>{let{elevationInfo:a}=t;F(i,a)&&this._snappingElevationAligner.notifyElevationSourceChange()}),u(()=>t.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),g),u(()=>this._layerView3D!=null?this._layerView3D.layer?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),g),S(()=>this._layerView3D?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())])}constructor(e){super(e),this.view=null,this.updating=!1,this._memoizedMakeGetGroundElevation=V(A)}refresh(){}async fetchCandidates(e,t){let{layer:i}=this.layerSource,a=i.source;if(!a?.querySnapping)return[];let l=i.createQuery();this._layerView&&"effectiveDisplayFilter"in this._layerView&&(l.where=_(l.where,this._layerView.effectiveDisplayFilter?.where));let p=E(e,this.view?.type??"2d",l),D=await a.querySnapping(p,{signal:t});s(t);let m=e.coordinateHelper.spatialReference,y=await this._snappingElevationAligner.alignCandidates(D.candidates,m,t);s(t);let d=await this._symbologySnappingFetcher.fetch(y,t);s(t);let I=d.length===0?y:[...y,...d],G=this._snappingElevationFilter.filter(p,I),k=this._memoizedMakeGetGroundElevation(this.view,m);return G.map(q=>C(q,k))}};n([o({constructOnly:!0})],r.prototype,"layerSource",void 0),n([o({constructOnly:!0})],r.prototype,"view",void 0),n([o()],r.prototype,"_snappingElevationAligner",null),n([o()],r.prototype,"_snappingElevationFilter",null),n([o()],r.prototype,"_symbologySnappingFetcher",null),n([o()],r.prototype,"_layerView",null),n([o()],r.prototype,"_layerView3D",null),n([o()],r.prototype,"_symbologySnappingSupported",null),r=n([f("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],r);export{r as FeatureCollectionSnappingSource};
