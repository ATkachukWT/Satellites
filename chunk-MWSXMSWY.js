import{f as x}from"./chunk-JRCKELO6.js";import{c as v}from"./chunk-YR2HD3ZC.js";import{F as L}from"./chunk-QHVIRF5H.js";import{A as C,E as y,d as f,j as h,m as A,p as b,r as M,s as g,u as d,x as p}from"./chunk-CKJ56T2Q.js";function E(r,s,n={}){return w(r,s,n,H)}function D(r,s,n={}){return w(r,s,n,P)}function w(r,s,n={},o){let e=null,i=n.once?(a,t)=>{o(a)&&(f(e),s(a,t))}:(a,t)=>{o(a)&&s(a,t)};if(e=L(r,i,n.sync,n.equals),n.initial){let a=r();i(a,a)}return e}function k(r,s,n,o={}){let e=null,i=null,a=null;function t(){e&&i&&(i.remove(),o.onListenerRemove?.(e),e=null,i=null)}function c(u){o.once&&o.once&&f(a),n(u)}let l=E(r,(u,m)=>{t(),M(u)&&(e=u,i=g(u,s,c),o.onListenerAdd?.(u))},{sync:o.sync,initial:!0});return a=h(()=>{l.remove(),t()}),a}function F(r,s){return O(r,P,s)}function O(r,s,n){if(p(n))return Promise.reject(d());let o=r();if(s?.(o))return Promise.resolve(o);let e=null;function i(){e=f(e)}return new Promise((a,t)=>{e=A([C(n,()=>{i(),t(d())}),w(r,c=>{i(),a(c)},{sync:!1,once:!0},s??H)])})}function H(r){return!0}function P(r){return!!r}function J(r,s,n={}){let o=!1,e=E(r,(i,a)=>{o||s(i,a)},n);return{remove(){e.remove()},pause(){o=!0},resume(){o=!1}}}function T(r,s){let n=new v,o=k(r,"after-splice",({added:e,start:i,deleteCount:a})=>{let t=n.splice(i,a);for(let c of t)c.remove();if(e?.length){let c=e.map(s);n.addMany(c,i)}},{sync:!0,onListenerRemove:()=>n.drain(e=>e.remove()),onListenerAdd:e=>n.addMany(e.items.map(s))});return n.addHandles(o),n}function K(r,s){let n=new v,o=T(r,t=>x(async c=>{let l=await s(t,c);if(p(c))throw l.remove(),d();return l})),e=()=>null,i=async t=>{let c=await t.promise,l=o.indexOf(t);l<0||n.splice(l,1,c)};n.addMany(o.items.map(e));for(let t of o)y(i(t));let a=o.on("after-splice",({added:t,start:c,deleteCount:l})=>{let u=n.splice(c,l);for(let m of u)m?.remove();if(t?.length){n.addMany(t.map(e),c);for(let m of t)y(i(m))}});return n.addHandles([b(o),a]),n}var N={sync:!0},Q={initial:!0},S={sync:!0,initial:!0};export{E as a,D as b,k as c,F as d,J as e,T as f,K as g,N as h,Q as i,S as j};
