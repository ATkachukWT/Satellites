import{a as _}from"./chunk-PIWEOJIH.js";import{c as v}from"./chunk-ZIK4TOX5.js";import{a as F}from"./chunk-THZF7PGR.js";import"./chunk-J4YX6XRI.js";import{a as k}from"./chunk-26JWDTE3.js";import{a as x}from"./chunk-5DVGZXEZ.js";import"./chunk-SDA472RA.js";import"./chunk-LXYWEX2U.js";import"./chunk-IBSCSNYA.js";import"./chunk-SPPN4AOM.js";import"./chunk-TY4DYZZJ.js";import"./chunk-54P55TN4.js";import"./chunk-BVDJBTNQ.js";import"./chunk-LSUWBOLF.js";import"./chunk-LHI3UGTZ.js";import"./chunk-XACQ2RJ5.js";import"./chunk-3TRID6QS.js";import"./chunk-WUXNV6ZW.js";import"./chunk-KE2U7ENE.js";import"./chunk-PSFZFYFC.js";import"./chunk-WIFM6OT5.js";import"./chunk-GI4NW5SA.js";import"./chunk-F4FOXK2P.js";import"./chunk-T5NHE3SD.js";import"./chunk-SXYHD4V6.js";import"./chunk-FSW536RM.js";import"./chunk-YNDA4ZZB.js";import"./chunk-JAN3FVXP.js";import"./chunk-F4HA2HQL.js";import"./chunk-BSKAVVQS.js";import"./chunk-AEU2INWT.js";import"./chunk-Z4UBZ6W2.js";import"./chunk-CMKJEBQJ.js";import"./chunk-3J3Q4LMA.js";import"./chunk-PSNQ2KG3.js";import"./chunk-LIKQ6DPU.js";import"./chunk-H6LI7TZP.js";import"./chunk-2IWALBQY.js";import"./chunk-IVHM64W3.js";import"./chunk-QQ5W5TEP.js";import"./chunk-YQHQQW4I.js";import"./chunk-7V6BRQYE.js";import"./chunk-IZU6TNEP.js";import"./chunk-DNN7JJKY.js";import"./chunk-Y7XG5IWW.js";import"./chunk-X5NPIY3C.js";import"./chunk-JXRFF2VE.js";import"./chunk-7WCQBAQY.js";import"./chunk-V4ZQZTCB.js";import"./chunk-PEYNLMWW.js";import"./chunk-FQIIIJGL.js";import"./chunk-SZTSN5BD.js";import"./chunk-VAOSSSLB.js";import"./chunk-6L543SC5.js";import"./chunk-CUV3BSEW.js";import"./chunk-6FI5AY7X.js";import"./chunk-ZCAR53EN.js";import"./chunk-DH67ILIV.js";import"./chunk-7GUYYJRR.js";import"./chunk-WS4AMEGN.js";import"./chunk-CU7FHMWW.js";import"./chunk-CSFAHB4Y.js";import"./chunk-AMISFAT3.js";import"./chunk-PTXLSCMJ.js";import"./chunk-NRRX2M6N.js";import"./chunk-PMLKCTEJ.js";import"./chunk-MYO2G5ZH.js";import"./chunk-MTUYS77G.js";import"./chunk-EG2DTURK.js";import"./chunk-57FV5BVL.js";import"./chunk-YVCKQBWT.js";import"./chunk-4XEE5PE3.js";import"./chunk-MBNZK2RR.js";import"./chunk-DV6KBPBR.js";import"./chunk-XWEUR6F7.js";import"./chunk-KALTBP5D.js";import"./chunk-O2J7LFYY.js";import"./chunk-422PSKZ7.js";import"./chunk-SFANISLX.js";import"./chunk-5L4CW2H2.js";import"./chunk-UJ7KVQR6.js";import"./chunk-B74L7AUE.js";import"./chunk-MJO3PLZV.js";import"./chunk-YU3IFRYW.js";import"./chunk-XKFJ6GWH.js";import"./chunk-GSXOR3JU.js";import"./chunk-55OTJIMU.js";import"./chunk-EM2AEAFS.js";import"./chunk-VGAXEXH3.js";import"./chunk-YEPHAEAY.js";import"./chunk-76X7RFM4.js";import"./chunk-HMNTGQTR.js";import"./chunk-ZLIWNUFM.js";import"./chunk-GVSOJUIP.js";import"./chunk-GWSX6PRO.js";import"./chunk-ELCBU4NP.js";import"./chunk-GMZFCQJQ.js";import"./chunk-5WDH2LXO.js";import"./chunk-L7NOU4T2.js";import"./chunk-SU7IJ65K.js";import"./chunk-WOZSH7YY.js";import"./chunk-2PJRHNJW.js";import"./chunk-B2RVSTL3.js";import"./chunk-2CKJLDTO.js";import"./chunk-F6TN7E7K.js";import"./chunk-HUUJBVXR.js";import"./chunk-4LDVFWME.js";import"./chunk-A45BLB26.js";import"./chunk-DFYW3Y3B.js";import"./chunk-UBQPWKE4.js";import"./chunk-YSD7LK2L.js";import{a as f}from"./chunk-BSSTF6JG.js";import"./chunk-4K47EN3B.js";import"./chunk-FGY3YBPM.js";import"./chunk-EDOVNTC7.js";import"./chunk-FSWSNKJD.js";import"./chunk-MVDZB4AK.js";import"./chunk-ESSDCWGF.js";import"./chunk-WVKBXQWE.js";import"./chunk-FGEB67EG.js";import"./chunk-YEXMIDOT.js";import"./chunk-GV3ZFCVD.js";import"./chunk-SOEEM7Z7.js";import"./chunk-T7PUQGWM.js";import"./chunk-44A27HB7.js";import"./chunk-47NSYSFY.js";import"./chunk-QXNVQZT7.js";import"./chunk-CAXK5KYB.js";import"./chunk-3CCK7BDD.js";import"./chunk-LNYBTIG7.js";import"./chunk-VYZHOYXV.js";import"./chunk-K7YQAHQ7.js";import"./chunk-J6YGDWJF.js";import"./chunk-YQNUGDFH.js";import"./chunk-QCZ3ZIGQ.js";import"./chunk-NNX76JDG.js";import"./chunk-76O2P2CB.js";import{a as c}from"./chunk-WPZN772I.js";import"./chunk-ONYJLWAD.js";import"./chunk-VMECOA4F.js";import"./chunk-PHODKV66.js";import"./chunk-JPMGMA4B.js";import"./chunk-3REMXE4W.js";import"./chunk-4ABKPPKG.js";import"./chunk-PMVQ5DJK.js";import"./chunk-I4Q2S2XA.js";import"./chunk-V774RJYN.js";import"./chunk-L2WNUKLP.js";import"./chunk-XITT4JU2.js";import"./chunk-ZBX6HJOS.js";import"./chunk-BSMAMABT.js";import"./chunk-LYNAYPL3.js";import"./chunk-ULANM5YP.js";import"./chunk-KAMRW6HF.js";import"./chunk-UWWWQ44M.js";import"./chunk-BHB4UQZT.js";import"./chunk-DJW5LMRG.js";import"./chunk-ALWV3RJ2.js";import"./chunk-DEH76MSI.js";import"./chunk-PHNFWHVF.js";import"./chunk-W26XKMAT.js";import"./chunk-NQWYPF77.js";import"./chunk-KRAKR4MK.js";import"./chunk-MCO7DSFO.js";import"./chunk-D7WE3OBT.js";import"./chunk-JTDXB5TK.js";import"./chunk-XCIPBOI4.js";import"./chunk-CWUY5SXW.js";import"./chunk-KD27XIJC.js";import"./chunk-XRRQM4E2.js";import"./chunk-GWBRHLNH.js";import"./chunk-S52JRLJC.js";import"./chunk-U4TLMQTY.js";import"./chunk-PDQQY7RQ.js";import"./chunk-W5OI4BJ2.js";import"./chunk-RWCIDBNQ.js";import"./chunk-2NH7HOKA.js";import"./chunk-HM5RIVQC.js";import"./chunk-EM35R6FY.js";import"./chunk-2ZFXOJDB.js";import"./chunk-QXXXCEV5.js";import"./chunk-6B5XFA6F.js";import"./chunk-HP4LYRR4.js";import"./chunk-AFC2H4Q3.js";import"./chunk-OLOKUDVI.js";import"./chunk-4G7UTTZJ.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-NRBJLISB.js";import"./chunk-PTZYZULI.js";import"./chunk-NMLYCCKN.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-FENRIY2T.js";import"./chunk-HX2VGIR2.js";import"./chunk-64QN2VGD.js";import"./chunk-JGEVVXD4.js";import"./chunk-B3FO6PT7.js";import"./chunk-C4UMJHQC.js";import"./chunk-BCREO4Q5.js";import"./chunk-LXFQWIWE.js";import"./chunk-QT6UNBJP.js";import"./chunk-V2GNNIXD.js";import"./chunk-NSYL2RQJ.js";import{c as w}from"./chunk-MWSXMSWY.js";import"./chunk-JRCKELO6.js";import"./chunk-ZVCMULXF.js";import"./chunk-KJULKTB5.js";import"./chunk-LACL4BQ2.js";import"./chunk-YR2HD3ZC.js";import"./chunk-GJASVPF6.js";import"./chunk-UBFCO3DV.js";import"./chunk-NI7FJV5X.js";import"./chunk-BUSG3ZOF.js";import"./chunk-XZIOXVVJ.js";import"./chunk-EXJYW3PC.js";import"./chunk-SXQPBCOX.js";import{m as g}from"./chunk-LFH24RLM.js";import"./chunk-Z5Q7KLA4.js";import"./chunk-X4LNX4BR.js";import"./chunk-4XZ6X7MQ.js";import"./chunk-WLHY3MMA.js";import"./chunk-KGVXGH6H.js";import"./chunk-ARRCN5K3.js";import{a as p}from"./chunk-LXQPIAN7.js";import"./chunk-FTDD7QBB.js";import"./chunk-DB3UIQCU.js";import"./chunk-SBHKMV3P.js";import"./chunk-R4A63S45.js";import"./chunk-ETE32IYO.js";import"./chunk-ONUGDWDK.js";import"./chunk-SG7CQU4O.js";import{H as i}from"./chunk-QHVIRF5H.js";import{I as l}from"./chunk-WZDN6K3C.js";import{a as n}from"./chunk-QGVBCWUY.js";import"./chunk-OJQ73TPF.js";import"./chunk-354SCPDU.js";import"./chunk-OVHPPCBL.js";import"./chunk-IYZFKXJ6.js";import{b as m,j as h}from"./chunk-CKJ56T2Q.js";import"./chunk-SNFOAZZQ.js";import"./chunk-F6JAWRPN.js";import{t as d}from"./chunk-UHRSAPGQ.js";import"./chunk-V76GWARL.js";import"./chunk-N2WTMF3X.js";var a=class extends p{constructor(e){super(e),this.schedule=null,this._workerUpdating=!0}get updating(){return this._workerUpdating}initialize(){this._workerHandle=new y(this.schedule,this);let{layer:e,viewSpatialReference:r,renderSpatialReference:t}=this;this.addResolvingPromise((async()=>{await e.load();let{fullExtent:o}=e;await this._workerHandle.invokeMethod("setup",{url:e.parsedUrl?.path??"",baseQuery:e.createQuery().toJSON(),viewSpatialReference:r.toJSON(),renderSpatialReference:t.toJSON(),viewingMode:this.viewingMode,objectIdField:e.objectIdField,capabilities:e.capabilities,timeInfo:e.timeInfo?.toJSON(),fieldsIndex:e.fieldsIndex.toJSON(),fullExtent:o?.toJSON()})})()),this.addHandles(this._workerHandle.on("notify-updating",({updating:o})=>{this._workerUpdating=o}))}onTileTreeChange({added:e,removed:r}){if(e.length===0&&r.length===0)return;let t=e.map(O),o=r.map(O);this._workerHandle.invokeMethod("onTileTreeChange",{added:t,removed:o})}async executeQuery(e,r){let t=await this._workerHandle.invokeMethod("executeQuery",e?.toJSON(),r),o=c.fromJSON(t);return this._ensureLayerOnFeatures(o),o}async executeQueryForIds(e,r){return await this._workerHandle.invokeMethod("executeQueryForIds",e?.toJSON(),r)}async executeQueryForCount(e,r){return await this._workerHandle.invokeMethod("executeQueryForCount",e?.toJSON(),r)}async executeQueryForExtent(e,r){let{count:t,extent:o}=await this._workerHandle.invokeMethod("executeQueryForExtent",e?.toJSON(),r);return{count:t,extent:g.fromJSON(o)}}async executeQueryForLatestObservations(e,r){let t=await this._workerHandle.invokeMethod("executeQueryForLatestObservations",e?.toJSON(),r),o=c.fromJSON(t);return this._ensureLayerOnFeatures(o),o}_ensureLayerOnFeatures(e){let{layer:r}=this;for(let t of e.features)t.layer=r,t.sourceLayer=r}};n([i()],a.prototype,"updating",null),n([i({constructOnly:!0})],a.prototype,"schedule",void 0),n([i({constructOnly:!0})],a.prototype,"layer",void 0),n([i({constructOnly:!0})],a.prototype,"viewSpatialReference",void 0),n([i({constructOnly:!0})],a.prototype,"renderSpatialReference",void 0),n([i({constructOnly:!0})],a.prototype,"viewingMode",void 0),n([i({constructOnly:!0})],a.prototype,"dispatchRenderCommands",void 0),n([i()],a.prototype,"_workerUpdating",void 0),a=n([l("esri.views.3d.layers.graphics.pipeline.Feature3DPipelineWorkerHandle")],a);var y=class extends f{constructor(r,t){super("Feature3DPipelineWorker","setup",{},r,{strategy:"dedicated",client:t})}};function O({id:e,lij:r,extent:t}){return{id:e,lij:r,extent:t}}var u=class extends p{constructor(e){super(e),this._renderer=null,this.graphicsQuery={queryForSymbologySnapping:(r,t)=>{throw new d("unsupported-symbology-snapping")},executeQuery:async(r,t)=>await this._workerHandle.executeQuery(r,t),executeQueryForIds:async(r,t)=>await this._workerHandle.executeQueryForIds(r,t),executeQueryForCount:async(r,t)=>await this._workerHandle.executeQueryForCount(r,t),executeQueryForExtent:async(r,t)=>await this._workerHandle.executeQueryForExtent(r,t),executeQueryForLatestObservations:async(r,t)=>await this._workerHandle.executeQueryForLatestObservations(r,t)},this.maximumNumberOfFeatures=1e3}initialize(){if(this.layerView.layer.geometryType!=="point")throw new d("unsupported-geometry-type",`${this.layerView.layer.geometryType} is not supported`);this.addResolvingPromise(this.setup())}destroy(){this.removeAllHandles(),this._workerHandle.destroy(),m(this._renderer)}async setup(){let{layer:e,view:r}=this.layerView,{spatialReference:t,renderSpatialReference:o,resourceController:H}=r,S=r.state.viewingMode;if(this._renderer=new F({view:r,layerUid:e.uid}),e.type!=="feature")throw new Error("Only FeatureLayer is supported");let b=new a({schedule:s=>H.immediate.schedule(s),layer:e,viewSpatialReference:t,renderSpatialReference:o,viewingMode:S,dispatchRenderCommands:s=>this._renderer.executeRenderCommands(s)});this._workerHandle=await b.when(),this.addHandles([this.layerView.view.featureTiles.addClient(),w(()=>this.layerView.view.featureTiles.tiles,"change",s=>{this._workerHandle.onTileTreeChange(s)},{onListenerAdd:s=>this._workerHandle.onTileTreeChange({added:s.toArray(),removed:[]}),onListenerRemove:s=>this._workerHandle.onTileTreeChange({added:[],removed:s.toArray()})})])}get legendEnabled(){return!1}get hasAllFeatures(){return!1}get hasAllFeaturesInView(){return!1}get hasFullGeometries(){return!1}get symbologySnappingSupported(){return!1}get scaleVisibilitySuspended(){return!1}get suspendInfo(){return{}}get updating(){return this._workerHandle.updating}get dataUpdating(){return!1}get updatePolicy(){return x.ASYNC}get maximumNumberOfFeaturesExceeded(){return!1}get updatingProgressValue(){return 1}get usedMemory(){return this._renderer?.usedMemory??0}get unloadedMemory(){return 0}get ignoresMemoryFactor(){return!0}get totalFeatures(){return this._renderer?.totalFeatures??0}get performanceInfo(){let e=this.totalFeatures;return new _(new k(this.usedMemory,e,e,this.maximumNumberOfFeatures,0,null),e,e,this.maximumNumberOfFeaturesExceeded,"tiles","n/a")}get suspendResumeExtentMode(){return"computed"}forEachGraphic(e){}findGraphic(e){return null}highlight(e){return v}maskOccludee(e){return h()}async whenGraphicBounds(e,r){return null}computeAttachmentOrigin(e,r){return null}elevationAlignPointsInFeatures(e,r){throw new d("unsupported-elevation-alignment")}async doRefresh(e){}setVisibility(e,r){}getMissingAttributesForFeature(e){return null}getHydratedGeometry(e){return null}};n([i()],u.prototype,"layerView",void 0),n([i()],u.prototype,"updating",null),n([i()],u.prototype,"totalFeatures",null),u=n([l("esri.views.3d.layers.graphics.pipeline.Feature3DPipeline")],u);export{u as Feature3DPipeline};
