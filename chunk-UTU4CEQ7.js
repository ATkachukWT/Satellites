import{a as B,b as D,c as C,f as Y,i as J,k as K}from"./chunk-3OYKXCYJ.js";import{g as X,h as A}from"./chunk-JAENS3D3.js";import{c as W}from"./chunk-3ATD3H4Q.js";import"./chunk-ME2B26KJ.js";import"./chunk-U7PX7SHO.js";import"./chunk-TMZQBNSB.js";import{A as E}from"./chunk-I4Q2S2XA.js";import"./chunk-V774RJYN.js";import"./chunk-L2WNUKLP.js";import"./chunk-XITT4JU2.js";import"./chunk-ZBX6HJOS.js";import"./chunk-BSMAMABT.js";import{d as U}from"./chunk-LYNAYPL3.js";import{d as j}from"./chunk-ULANM5YP.js";import"./chunk-2G3SBK6Q.js";import"./chunk-VOB6IBIW.js";import"./chunk-63B3IOWG.js";import{a as O}from"./chunk-KAMRW6HF.js";import"./chunk-JTDXB5TK.js";import"./chunk-KD27XIJC.js";import"./chunk-NHEQ4TAR.js";import"./chunk-BIRSPTTF.js";import"./chunk-IZLELRQR.js";import"./chunk-7EMOONQX.js";import"./chunk-RZF6KTKU.js";import"./chunk-HP4LYRR4.js";import"./chunk-AFC2H4Q3.js";import"./chunk-OLOKUDVI.js";import"./chunk-4G7UTTZJ.js";import"./chunk-ZTOZWLEE.js";import"./chunk-RJWOVI3M.js";import"./chunk-NRBJLISB.js";import"./chunk-RSDQHAJX.js";import"./chunk-BOVYXYHK.js";import"./chunk-5HJY3X5Y.js";import"./chunk-6RZAM42M.js";import"./chunk-HX2VGIR2.js";import"./chunk-64QN2VGD.js";import"./chunk-LXFQWIWE.js";import"./chunk-QT6UNBJP.js";import{a as H}from"./chunk-MDSLION2.js";import"./chunk-6Z6LKUG5.js";import"./chunk-V2GNNIXD.js";import"./chunk-NSYL2RQJ.js";import"./chunk-MWSXMSWY.js";import"./chunk-JRCKELO6.js";import"./chunk-ZVCMULXF.js";import"./chunk-KJULKTB5.js";import"./chunk-LACL4BQ2.js";import"./chunk-YR2HD3ZC.js";import"./chunk-GJASVPF6.js";import"./chunk-UBFCO3DV.js";import"./chunk-XZIOXVVJ.js";import"./chunk-EXJYW3PC.js";import"./chunk-SXQPBCOX.js";import"./chunk-LFH24RLM.js";import"./chunk-Z5Q7KLA4.js";import"./chunk-X4LNX4BR.js";import"./chunk-4XZ6X7MQ.js";import"./chunk-WLHY3MMA.js";import"./chunk-KGVXGH6H.js";import"./chunk-ARRCN5K3.js";import"./chunk-LXQPIAN7.js";import"./chunk-FTDD7QBB.js";import"./chunk-DB3UIQCU.js";import"./chunk-SBHKMV3P.js";import"./chunk-R4A63S45.js";import"./chunk-ETE32IYO.js";import"./chunk-ONUGDWDK.js";import"./chunk-SG7CQU4O.js";import"./chunk-QHVIRF5H.js";import"./chunk-WZDN6K3C.js";import"./chunk-QGVBCWUY.js";import"./chunk-OJQ73TPF.js";import"./chunk-354SCPDU.js";import"./chunk-OVHPPCBL.js";import"./chunk-IYZFKXJ6.js";import"./chunk-CKJ56T2Q.js";import"./chunk-SNFOAZZQ.js";import"./chunk-F6JAWRPN.js";import{b as G}from"./chunk-UHRSAPGQ.js";import"./chunk-V76GWARL.js";import"./chunk-N2WTMF3X.js";var q;function oe(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function F(e){return e?.type==="CIMVectorMarker"?e.markerGraphics?.[0]:void 0}function Q(e){return e?.symbol?.type==="CIMPolygonSymbol"?e.symbol.symbolLayers?.[0]:void 0}function ae(e,n){e?.type==="CIMVectorMarker"&&n!=null&&(e.size=n)}function le(e,n){let r=F(e);r&&n!=null&&(r.geometry=oe(n))}function se(e,n){let r=Q(F(e));r&&n!=null&&(r.color=n.toArray())}function ce(e,n,r){let i=Q(F(e));i&&n!=null&&r&&(i.colorLocked=n)}function Z(e,n){let{outerRingSize:r,innerDotSize:i,type:t,color:o,colorLocked:a,primitiveOverrides:l}=n,u=e.data.symbol?.type==="CIMPolygonSymbol"?e.data.symbol.symbolLayers:null;if(u?.length===2)for(let c of u){let m=c.primitiveName===q.OuterRing;ae(c,m?r:i),le(c,t),se(c,o),ce(c,a,m)}return r!=null&&i!=null&&(e.data.primitiveOverrides=null),l!==void 0&&(e.data.primitiveOverrides=G(l)),e}(function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"})(q||(q={}));var _=30,ee=12,N=24,ne=[255,255,255],T=[200,200,200],x=[128,128,128],ue=20,me=5;function fe(e){return e.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function ye(e){return e.declaredClass==="esri.symbols.PictureMarkerSymbol"}function pe(e){return e.declaredClass==="esri.symbols.SimpleLineSymbol"}function Se(e){return e.declaredClass==="esri.symbols.TextSymbol"}function be(e,n){let r=e.length-1;return e.map((i,t)=>Y(i,t,r,n))}async function Xe(e,n,r,i,t,o,a){let l=n.legendOptions,u=l?.customValues,c=a||await ge(e,r),m=n.stops,P=!!c,S=!!u,b=n.minSize!=null&&n.maxSize!=null,v=m&&m.length>1,z=!!n.target;if(!P||!S&&!(b||v&&!z))return;let f=A(c),y=!1,s=null,w=null;s=f&&!v?C([n.minDataValue,n.maxDataValue]):u??await xe(n,c,i,t?.type);let I=e?.authoringInfo,M=I?.type==="univariate-color-size",$=M&&I?.univariateTheme==="above-and-below",k=!!K(e);if(!s&&v&&(s=m.map(p=>p.value),y=m.some(p=>!!p.label),e.type==="flow"&&(s=C(s)),y&&(w=m.map(p=>p.label))),f&&s!=null&&s?.length>2&&!$&&(s=[s[0],s[s.length-1]]),!s)return null;M&&s?.length!==5&&(s=ie({minSize:s[0],maxSize:s[s.length-1]}));let R=f?ve(e,s):null,d=X(c),g=y?null:be(s,o);return(await Promise.all(s.map(async(p,V)=>{let L=f?R[V]:await h(n,c,p,i,t?.type);return{value:p,symbol:!k||e.type!=="class-breaks"&&e.type!=="unique-value"?Me($&&e.type==="class-breaks"?de(e,V):c,L):ze(e,L,n.maxSize,r)??c,label:y?w[V]:g[V],size:k?N:L,outlineSize:d}}))).reverse()}function ve(e,n){let r=e?.authoringInfo,i=r?.type==="univariate-color-size",t=[ee,_];if(i){let o=n[0],a=n[n.length-1],l=ee,u=_;t=n.map(c=>l+(c-o)/(a-o)*(u-l))}return i&&r?.univariateTheme==="below"&&t.reverse(),t}function ze(e,n,r,i){let t=e.type==="class-breaks",o=t?e.classBreakInfos?.[0]?.symbol?.clone():e.uniqueValueInfos?.[0]?.symbol?.clone();return o&&"type"in o&&o.type==="cim"?(Z(o,{color:i??(t?null:new O(T)),innerDotSize:n*(N/r)||1,outerRingSize:N}),o):null}function de(e,n){let r=e.classBreakInfos,i=r.length,t=i<2||!(n>=2)?r[0].symbol.clone():r[i-1].symbol.clone();return e.visualVariables?.some(a=>a.type==="color")&&(t.type.includes("3d")?re(t):te(t)),t}async function ge(e,n){if(e.type==="flow")return J(e,n);if(e.type==="pie-chart")return new U({color:null,outline:e.outline?.width?e.outline:new j});let r=null,i=null;if(e.type==="simple")r=e.symbol;else if(e.type==="class-breaks"){let t=e.classBreakInfos;r=t&&t[0]&&t[0].symbol,i=t.length>1}else if(e.type==="unique-value"){let t=e.uniqueValueInfos;r=t?.[0]?.symbol,i=t!=null&&t.length>1}return!r||he(r)?null:(r=r.clone(),(n||i)&&(r.type.includes("3d")?re(r):te(r)),r)}function he(e){return E(e)?e.symbolLayers?.some(n=>n?.type==="fill")??!1:e?.type.includes("fill")??!1}function re(e){e.type==="line-3d"?e.symbolLayers.forEach(n=>{n.material={color:x}}):e.symbolLayers.forEach(n=>{n.type!=="icon"||n.resource?.href?n.material={color:T}:(n.material={color:ne},n.outline={color:x,size:1.5})})}function te(e){let n=H();e.type==="cim"?W(e,new O(T)):e.type.includes("line")?e.color=x:(e.color=n?x:ne,e.type==="simple-marker"&&(e.outline?e.outline?.color?.toHex()==="#ffffff"&&(e.outline.color=x):e.outline={color:x,width:1.5}))}async function xe(e,n,r,i){let t=(await import("./chunk-E55JLOAL.js")).getSizeRangeAtScale(e,r,i),o=t&&ie(t);if(!t||!o)return;let a=o.map(l=>we(l,e,t));a=C(a);for(let l=1;l<a.length-1;l++){let u=await Ie(e,n,a[l],a[l-1],r,i);u&&(a[l]=u[0],o[l]=u[1])}return a}function ie(e){let n=e.minSize,r=e.maxSize,i=me,t=(r-n)/(i-1),o=[];for(let a=0;a<i;a++)o.push(n+t*a);return o}function we(e,n,r){let i=r.minSize,t=r.maxSize,o=n.minDataValue,a=n.maxDataValue,l;return e<=i?l=o:e>=t?l=a:l=(e-i)/(t-i)*(a-o)+o,l}async function Ie(e,n,r,i,t,o){let a=await h(e,n,r,t,o),l=await h(e,n,i,t,o),u=B(r),c=u.fractional,m=ue,P=u.integer,S=null,b=null;r>0&&r<1&&(S=10**c,P=B(r*=S).integer);for(let v=P-1;v>=0;v--){let z=10**v,f=Math.floor(r/z)*z,y=Math.ceil(r/z)*z;S!=null&&(f/=S,y/=S);let s=(f+y)/2;[,s]=C([f,s,y],{indexes:[1]});let w=await h(e,n,f,t,o),I=await h(e,n,y,t,o),M=await h(e,n,s,t,o),$=D(a,w,l,null),k=D(a,I,l,null),R=D(a,M,l,null),d=$.previous<=m,g=k.previous<=m;if(d&&g&&($.previous<=k.previous?(d=!0,g=!1):(g=!0,d=!1)),d?b=[f,w]:g?b=[y,I]:R.previous<=m&&(b=[s,M]),b)break}return b}async function h(e,n,r,i,t){let{getSize:o}=await import("./chunk-E55JLOAL.js");return o(e,r,{scale:i,view:t,shape:n.type==="simple-marker"?n.style:null})}function Me(e,n){let r=e.clone();if(E(r))A(r)||r.symbolLayers.forEach(i=>{i.type!=="fill"&&(i.size=n)});else if(fe(r))r.size=n;else if(ye(r)){let i=r.width,t=r.height;r.height=n,r.width=n*(i/t)}else pe(r)?r.width=n:Se(r)&&r.font&&(r.font.size=n);return r}export{Xe as getRampStops,ze as getReferenceSizeSymbol,_ as realWorldMaxSize,ee as realWorldMinSize};
